(this.webpackJsonptictactoe_react=this.webpackJsonptictactoe_react||[]).push([[0],{18:function(e,t,r){},19:function(e,t,r){},20:function(e,t,r){},22:function(e,t,r){},23:function(e,t,r){"use strict";r.r(t);var n=r(3),s=r.n(n),a=r(10),i=r.n(a),o=(r(18),r(1)),c=r(2),u=r(6),h=r(4);r(19);function l(){return new Worker(r.p+"static/js/tictactoe-ai.worker.bd4a8cda.worker.js")}var f=function(){function e(){Object(o.a)(this,e),this.worker=new l}return Object(c.a)(e,[{key:"postMessage",value:function(e){this.worker.postMessage(e)}},{key:"addEventListener",value:function(e,t){this.worker.addEventListener(e,t)}}]),e}(),v=r(13),d=(r(20),r(0));function m(e){return Object(d.jsxs)("div",{className:"highscores",children:[Object(d.jsx)("h2",{children:"Highscores"}),Object(d.jsx)("div",{className:"centering",children:Object(d.jsxs)("table",{children:[Object(d.jsx)("thead",{children:Object(d.jsxs)("tr",{children:[Object(d.jsx)("th",{children:"Score"}),Object(d.jsx)("th",{children:"Name"}),Object(d.jsx)("th",{children:"Date"})]})}),Object(d.jsx)("tbody",{children:e.scores.scores.map((function(e,t){return Object(d.jsxs)("tr",{className:"score-row",children:[Object(d.jsx)("td",{children:e.score}),Object(d.jsx)("td",{children:e.name}),Object(d.jsx)("td",{children:j(e.time)})]},t)}))})]})})]})}function j(e){var t=e.split(" "),r=Object(v.a)(t,5),n=r[1],s=r[2],a=r[3],i=r[4];return"".concat(s," ").concat(n," ").concat(a," - ").concat(i)}var b=function(e){Object(u.a)(r,e);var t=Object(h.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).state={value:""},n}return Object(c.a)(r,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.onNameSubmitted&&this.props.onNameSubmitted(this.state.value)}},{key:"render",value:function(){var e=this;return Object(d.jsxs)("div",{children:[Object(d.jsx)("h2",{children:"You Made it to the Highscores"}),Object(d.jsx)("form",{onSubmit:function(t){return e.handleSubmit(t)},children:Object(d.jsxs)("label",{children:["Enter Name:",Object(d.jsx)("input",{type:"text",value:this.state.value,onChange:function(t){return e.handleChange(t)}})]})})]})}}]),r}(s.a.Component),g=r(5),y=(r(22),function(e){Object(u.a)(r,e);var t=Object(h.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(c.a)(r,[{key:"render",value:function(){var e=this;return Object(d.jsx)("button",{className:"square",onClick:function(){return e.props.onClick()},children:this.props.value})}}]),r}(s.a.Component)),k=function(e){Object(u.a)(r,e);var t=Object(h.a)(r);function r(){return Object(o.a)(this,r),t.apply(this,arguments)}return Object(c.a)(r,[{key:"renderSquare",value:function(e,t){var r=this;return Object(d.jsx)(y,{value:this.props.getSquareSymbol(e),onClick:function(){return t?r.doNada():r.handleClick(e)}},e)}},{key:"doNada",value:function(){}},{key:"handleClick",value:function(e){this.props.onClick(e)}},{key:"renderRow",value:function(e,t,r){var n=this,s=Object(g.a)(Array(t).keys());return Object(d.jsx)("div",{className:"board-row",children:s.map((function(t){return n.renderSquare(e+t,r)}))},e)}},{key:"render",value:function(){var e=this,t=!this.props.onClick,r=this.props.size,n=Object(g.a)(Array(r).keys());return Object(d.jsx)("div",{className:"game-board",children:Object(d.jsx)("div",{children:n.map((function(n){return e.renderRow(n*r,r,t)}))})})}}]),r}(s.a.Component),O=r(11),p=Object(O.a)("_scores"),S=function(){function e(){Object(o.a)(this,e),Object.defineProperty(this,p,{writable:!0,value:void 0}),this._scores=localStorage.getItem("scores")?JSON.parse(localStorage.getItem("scores")):[]}return Object(c.a)(e,[{key:"addScore",value:function(e,t){this._scores.push({score:e,name:t,time:Date()}),this._scores.sort((function(e,t){return t.score-e.score})),this._save()}},{key:"scores",get:function(){return Object(g.a)(this._scores)}},{key:"_save",value:function(){localStorage.setItem("scores",JSON.stringify(this._scores))}},{key:"reset",value:function(){this._scores=[],this._save()}}]),e}(),_=r(12),x=function(){function e(t){if(Object(o.a)(this,e),t<3||t%2!==1)throw new Error("The argument size: '".concat(t,"' is not valid for tic tac toe (3, 5, 7, ...)"));this._size=t,this.reset()}return Object(c.a)(e,[{key:"size",get:function(){return this._size}},{key:"turn",get:function(){return this._turn}},{key:"squares",get:function(){return Object(g.a)(this._squares)}},{key:"from",value:function(){var t=new e(this.size);t._turn=this.turn;for(var r=0;r<this._squares.length;r++)t._squares[r]=this._squares[r];return t}},{key:"reset",value:function(){this._turn=0,this._squares=Array(this.size*this.size).fill(null)}},{key:"_scoreSegment",value:function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._squares[e],s=this._squares,a=0,i=0;i<r;i++,e+=t)n===s[e]&&a++;return a}},{key:"_getChecks",value:function(){for(var e=this.size,t=[[0,e+1],[e-1,e-1]],r=0;r<e;r++)t.push([r*e,1]),t.push([r,e]);return t}},{key:"getScore",value:function(e){for(var t=this._getChecks(),r=0,n=this.size,s=0;s<t.length;s++){var a=this._scoreSegment(t[s][0],t[s][1],n,e);a>r&&(r=a)}return r}},{key:"checkWinner",value:function(){for(var e=this.size,t=this._getChecks(),r=0;r<t.length;r++)if(this._scoreSegment(t[r][0],t[r][1],e)===e)return this._squares[t[r][0]];return!1}},{key:"getTurnSymbol",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.turn;return e%2===0?"X":"O"}},{key:"getSquareSymbol",value:function(e){return this._squares[e]}},{key:"countPlayerSymbols",value:function(e){return this._squares.reduce((function(t,r){return r===e?t+1:t}),0)}},{key:"getValidMoves",value:function(){var e=this,t=this.getTurnSymbol();if(!(this.countPlayerSymbols(t)>=this.size)){var r=[];return this._squares.forEach((function(t,n){(function(e,t,r){return(0!==t||e!==Math.floor(r.length/2))&&null===r[e]})(n,e.turn,e._squares)&&r.push({to:n})})),r}var n=function(){for(var r=[],n=function(n){if(e.getSquareSymbol(n)===t){e._squares[n]=null;var s=e.getValidMoves();e._squares[n]=t,s.forEach((function(e){n!==e.to&&r.push({from:n,to:e.to})}))}},s=0;s<e._squares.length;s++)n(s);return{v:r}}();if("object"===typeof n)return n.v}},{key:"doMove",value:function(e){Number.isInteger(e)&&(e=null===this._squares[e]?{to:e}:{from:e});var t,r=this.getValidMoves(),n=Object(_.a)(r);try{for(n.s();!(t=n.n()).done;){var s=t.value;if(e.from===s.from&&(void 0===e.to||e.to===s.to))return void 0!==e.from&&(this._squares[e.from]=null),void 0!==e.to&&(this._squares[e.to]=this.getTurnSymbol(),this._turn++),!0}}catch(a){n.e(a)}finally{n.f()}return!1}}],[{key:"createFrom",value:function(t,r){var n=new e(Math.floor(Math.sqrt(t.length)));if(n._turn=r,n._squares.length!==t.length)throw new Error("The argument squares length: '".concat(t.length,"' is not valid for tic tac toe (9, 25, 49, ...)"));for(var s=0;s<t.length;s++)n._squares[s]=t[s];return n}}]),e}();function w(e){if(!e instanceof x)throw new TypeError("argument tttGame is not an instance of TicTacToe");var t=q(e.from(),0,e.size<5?6:2);return Array.isArray(t)?t[1]:(console.log("AI is screwed... doing random move"),function(e){if(!e instanceof x)throw new TypeError("argument tttGame is not an instance of TicTacToe");var t,r=e.getValidMoves();do{t=r[Math.floor(Math.random()*r.length)]}while(t.to===t.from);return t}(e))}function q(e,t,r){for(var n=e.getValidMoves(),s=[],a=0;a<n.length;a++){if(C(e.from(),n[a])===e.size)return[e.size,n[a]];if(t+1<r){var i=e.from();i.doMove(n[a]);var o=q(i,t+1,r);if(!Array.isArray(o))return[e.size,n[a]];Math.abs(o[0])<e.size&&s.push([-o[0],n[a]])}else s.push([0,n[a]])}if(s.sort((function(e,t){return t-e})),s.length>1)for(;s[0][0]!==s[s.length-1][0];)s.pop();return s[Math.floor(Math.random()*s.length)]}function C(e,t){var r=e.getTurnSymbol();return e.doMove(t),e.getScore(r)}function N(e){return Object(d.jsx)("div",{children:e.status})}function T(e){return Object(d.jsx)("button",{onClick:e.onClick,children:e.text})}var M=function(e){Object(u.a)(r,e);var t=Object(h.a)(r);function r(e){var n;return Object(o.a)(this,r),(n=t.call(this,e)).state={status:"Game Not Started",scores:new S,game:new x(3)},n.aiWorker=new f,n.aiWorker.addEventListener("message",(function(e){n.onBoardClick(e.data.ix)})),n}return Object(c.a)(r,[{key:"onBoardClick",value:function(e){var t=this,r=this.state.game.turn;if(this.state.game.doMove(e)&&(this.onGameUpdate(this.state.game),!this.state.game.checkWinner()&&this.isAITurn()&&r!==this.state.game.turn)){var n=this.state.game;if(this.props.noAITimer){var s=w(n);n.doMove(s),this.onGameUpdate(this.state.game)}else setTimeout((function(){t.aiWorker.postMessage({gameSquares:n.squares,turn:n.turn})}),2e3)}}},{key:"onGameUpdate",value:function(e){var t=e.checkWinner(),r=this.state.newScore;t&&(r=e.turn),this.setState({game:e,scores:this.state.scores,newScore:r})}},{key:"onNameSubmitted",value:function(e){this.state.scores.addScore(this.state.newScore,e),this.setState({game:this.state.game,scores:this.state.scores,newScore:void 0})}},{key:"isAITurn",value:function(){var e=this.state.game;return e.getTurnSymbol()===e.getTurnSymbol(1)}},{key:"resetGame",value:function(){this.setState({game:new x(this.state.game.size),scores:this.state.scores,newScore:void 0})}},{key:"resetHighscores",value:function(){this.state.scores.reset(),this.setState({game:this.state.game,scores:this.state.scores,newScore:void 0})}},{key:"render",value:function(){var e=this,t=this.state.game,r="Turn: ".concat(t.turn+1," Next Player: ").concat(t.getTurnSymbol()),n=t.checkWinner();n&&(r="Winner is: ".concat(n," at Turn: ").concat(t.turn));var s=t.checkWinner()||this.isAITurn()||this.state.newScore?void 0:function(t){e.onBoardClick(t)};return Object(d.jsxs)("div",{className:"game",children:[Object(d.jsx)("div",{className:"game-info",children:Object(d.jsx)(N,{status:r})}),Object(d.jsx)(k,{onClick:s,size:t.size,getSquareSymbol:function(e){return t.getSquareSymbol(e)}}),Object(d.jsx)("div",{className:"controls",children:Object(d.jsx)(T,{text:"Reset Game",onClick:function(){e.resetGame()}})}),this.state.newScore?Object(d.jsx)(b,{onNameSubmitted:function(t){e.onNameSubmitted(t)}}):"",Object(d.jsx)(m,{scores:this.state.scores}),Object(d.jsx)("div",{className:"controls",children:Object(d.jsx)(T,{text:"Reset Highscores",onClick:function(){e.resetHighscores()}})})]})}}]),r}(s.a.Component);i.a.render(Object(d.jsx)(M,{}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.ba692f31.chunk.js.map